<@row>
    <@columns>
		<@box color='primary'>
            <@boxHeader title='#i18n{forms.manageForm.title}' boxTools=true>
                <#if permission_create_forms>
                    <@aButton href='jsp/admin/plugins/forms/ManageForms.jsp?view=createForm' buttonIcon='plus' title='#i18n{forms.manageForm.buttonAdd}' hideTitle=['xs','sm'] size='sm' />
                </#if>
            </@boxHeader>
			<@boxBody>
                <@table>
                    <tr>
                        <th>#i18n{forms.manageForm.columnTitle}</th>
                        <th>#i18n{forms.manageForm.columnActions}</th>
                        <@th hide=['xs']>#i18n{forms.manageForm.columnPeriodDisponibility}</@th>
                    </tr>
                    <#list form_list as form>
                        <tr id="form_${form.id}">
                            <td>
                                <#assign hasAction=false />
                                <#if form.actions?exists>
                                    <#list form.actions as action>
                                        <#if action.permission=='MODIFY'>
                                            <@link href='${action.url}&id_form=${form.id}' title='${form.title}'>${form.title}</@link>
                                            <#break>
	                                    </#if>
                                    </#list>
								<#else>
									${form.title}
                                </#if>
								
                                <@div hide=['sm','md','lg','xl']>
                                    #i18n{forms.manageForm.columnPeriodDisponibility} : 
                                    <#setting locale=locale.language>
                                    <#if form.active>
                                        <#if form.availabilityStartDate?? && form.availabilityEndDate?? && form.availabilityStartDate==form.availabilityEndDate>
                                            #i18n{forms.manageForm.columnPeriodDisponibilityThe} ${form.availabilityStartDate}
                                        <#elseif form.availabilityStartDate?? && form.availabilityEndDate??>
                                            #i18n{forms.manageForm.columnPeriodDisponibilityFromTo} ${form.availabilityStartDate} #i18n{forms.manageForm.columnPeriodDisponibilityTo} ${form.availabilityEndDate}
                                        <#elseif form.availabilityStartDate??>
                                            #i18n{forms.manageForm.columnPeriodDisponibilitySince} ${form.availabilityStartDate} 
                                        <#elseif form.availabilityEndDate??>
                                            #i18n{forms.manageForm.columnPeriodDisponibilityUntil} ${form.availabilityEndDate} 
                                        </#if>
                                    <#else>
                                        <#if form.availabilityStartDate?? && form.availabilityStartDate &gt; .now?datetime>
                                            <span class='text-danger'>#i18n{forms.manageForm.columnPeriodDisponibilityFrom} ${form.availabilityStartDate}</span>
                                        <#else>    
                                            <@tag color='danger'>#i18n{forms.manageForm.unavailable}</@tag>
                                        </#if> 
                                    </#if>
                                </@div>
                            </td>
                            <td>
                                <#if form.actions?exists>
                                    <#list form.actions as action>
                                        <#assign color='' />
                                        <#assign params='' />
                                        <#if action.permission=='DELETE'>
                                            <#assign color = 'danger' />
										<#else>
											<#assign color = 'primary' />
                                        </#if>
                                        <#if action.permission=='PUBLISH'>
                                            <#assign params='data-toggle="modal" data-target="#pubModal"' />
                                        </#if>
                                        <@aButton href='${action.url}&id_form=${form.id}' title='${action.name}' hideTitle=['all'] color='${color}' class='${action.permission?lower_case}' buttonIcon=action.iconUrl params=params size='sm' />
                                    </#list>
                                </#if>
                                <#if form.active>
                                    <@aButton href='jsp/site/Portal.jsp?page=forms&view=stepView&id_form=${form.id}&init=true' title='#i18n{forms.manageForm.FOLink.label} ${form.title}' hideTitle=['all'] params='target="_blank"' buttonIcon='external-link' size='sm' color='success' />
                                </#if>
                            </td>
                            <@td hide=['xs']>
                                <@link href='jsp/admin/plugins/forms/ManageForms.jsp?view=modifyPublication&amp;id_form=${form.id}' title='#i18n{forms.action.publish.name}' params='data-toggle="modal" data-target="#pubModal"'>
                                    <#setting locale=locale.language>
                                    <#if form.active>
                                        <@icon style='check' class='text-success' />&nbsp;
                                        <#if form.availabilityStartDate?? && form.availabilityEndDate?? && form.availabilityStartDate==form.availabilityEndDate>
                                            #i18n{forms.manageForm.columnPeriodDisponibilityThe} ${form.availabilityStartDate}
                                        <#elseif form.availabilityStartDate?? && form.availabilityEndDate??>
                                            #i18n{forms.manageForm.columnPeriodDisponibilityFromTo} ${form.availabilityStartDate} #i18n{forms.manageForm.columnPeriodDisponibilityTo} ${form.availabilityEndDate}
                                        <#elseif form.availabilityStartDate??>
                                            #i18n{forms.manageForm.columnPeriodDisponibilitySince} ${form.availabilityStartDate} 
                                        <#elseif form.availabilityEndDate??>
                                            #i18n{forms.manageForm.columnPeriodDisponibilityUntil} ${form.availabilityEndDate} 
                                        </#if>
                                    <#else>
                                        <#if form.availabilityStartDate?? &&  form.availabilityStartDate &gt; .now?datetime>
                                            <@icon style='clock-o' class='fa-fw text-info' /> <span class='text-info'>#i18n{forms.manageForm.columnPeriodDisponibilityFrom} ${form.availabilityStartDate} </span>
                                        <#else>    
                                            <@icon style='close' class='fa-fw text-danger' /> <@tag color='danger' >#i18n{forms.manageForm.unavailable}</@tag>
                                        </#if> 
                                    </#if>
                                </@link>
                            </@td>
                        </tr>
                    </#list>
                </@table>
                <@paginationAdmin paginator=paginator combo=1 showcount=0 />
            </@boxBody>
        </@box>
    </@columns>
</@row>

<@toastr infos=infos warnings=warnings errors=errors />

<@formModal id='pubModal' />

<@scrollTopBtn />